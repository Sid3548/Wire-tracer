<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Wire Tracer — Company UI</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <div class="wrap">
    <header class="app-header">
      <div class="logo">WT</div>
      <div class="title">
        <h1>Wire Tracer</h1>
        <p>Hybrid pipeline — vector extraction + AI vision </p>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <form id="traceForm">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div style="display:flex;flex-direction:column">
              <label style="margin:0">Project</label>
              <input id="projectName" type="text" placeholder="Project name (optional)">
            </div>
            <div style="text-align:right">
              <div class="small-muted">v1.2 • local</div>
              <div class="meta">Project number- ABCDEFG / Wires</div>
            </div>
          </div>

          <label>PDF (path or drag & drop)</label>
          <div id="fileDrop" class="file-drop card small" tabindex="0">
            <input id="pdfPath" type="text" placeholder="C:/path/to/schematic.pdf" style="border:none;background:transparent;outline:none">
            <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
              <button type="button" class="btn ghost" id="chooseBtn">Choose</button>
              <span class="muted">or drop file</span>
            </div>
          </div>

          <div style="display:grid;grid-template-columns:1fr 120px;gap:12px;margin-top:12px">
            <div>
              <label>Gemini API Key</label>
              <input id="apiKey" type="password" placeholder="API key">
            </div>
            <div>
              <label>Page</label>
              <input id="page" type="number" min="1" value="1">
            </div>
          </div>

          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px">
            <div>
              <label>FROM Token</label>
              <input id="fromToken" type="text" placeholder="XC">
            </div>
            <div>
              <label>TO Token</label>
              <input id="toToken" type="text" placeholder="XIF">
            </div>
          </div>

          <div style="display:flex;gap:10px;align-items:center;margin-top:14px">
            <div style="flex:1">
              <label>Model</label>
              <select id="model" style="width:100%">
                <option value="gemini-2.0-flash-lite">Gemini 2.0 Flash Lite</option>
                <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
                <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
              </select>
            </div>
            <div style="width:180px">
              <label>Preview</label>
              <button id="previewBtn" type="button" class="btn" style="width:100%">Preview Page</button>
            </div>
          </div>

          <div style="display:flex;gap:8px;margin-top:16px;align-items:center">
            <button id="traceBtn" class="btn" type="submit">Trace Wires</button>
            <button id="clearBtn" class="btn ghost" type="button">Clear</button>
            <div style="margin-left:auto" class="small-muted">Auto-detect: <span class="chip">ON</span></div>
          </div>

          <div style="margin-top:14px">
            <div id="status" class="status">
              <div class="dot"></div>
              <div class="muted">Idle</div>
            </div>
          </div>

          <div style="margin-top:12px" class="meta">
            Quick tips: Drag a PDF into the file box, set page number, confirm tokens. Preview first if the schematic is large.
          </div>
        </form>
      </div>

      <div>
        <div class="card preview">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small-muted">Page Preview</div>
              <div style="font-weight:700">Visual check</div>
            </div>
            <div class="controls">
              <div class="badge" id="previewMeta">Page 1</div>
              <button id="zoomIn" class="btn ghost">Zoom +</button>
              <button id="zoomOut" class="btn ghost">Zoom -</button>
            </div>
          </div>

          <div id="previewCard" style="margin-top:12px;display:none">
            <div style="display:flex;gap:12px">
              <div style="flex:1;min-width:0">
                <div class="image-container" style="background:white;padding:14px;border-radius:10px">
                  <img id="previewImage" src="" alt="preview">
                </div>
              </div>
            </div>
          </div>

          <div id="resultPanel" style="margin-top:12px">
            <div class="results-toolbar">
              <div style="display:flex;gap:12px;align-items:center">
                <div class="small-muted">Results</div>
                <div class="meta">Connections found: <strong id="connCount">0</strong></div>
              </div>

              <div style="display:flex;gap:8px;align-items:center">
                <div class="search">
                  <input id="resultsFilter" placeholder="Search from/to/desc" style="padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)">
                </div>
                <button id="copyBtn" class="btn ghost">Copy</button>
                <button id="exportBtn" class="btn">Export CSV</button>
              </div>
            </div>

            <div class="table">
              <table id="resultsTable">
                <thead>
                  <tr><th>From</th><th>To</th><th>Description</th></tr>
                </thead>
                <tbody id="resultsBody"></tbody>
              </table>
            </div>

          </div>
        </div>
      </div>

    </div>
  </div>

  <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
